<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Bank Loan</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="../home.css">
</head>
<body>
<div class="navbar">
    <h2>Bank Loan System</h2>
    <div class="navbar-links" id="navbarLinks">
        <a href="customer-form.html">Home</a>
        <a href="../LoanProducts/products.html">Products</a>
        <a href="#">Applications</a>
        <!-- This will change based on login status -->
        <a href="login.html" id="loginButton">Login/Register</a>
    </div>
</div>

<div class="body-sub">
    <div class="banner">
        <div class="banner-content">
            <h1>Get Your Loan Approved Faster!</h1>
            <p>Quick, secure, and hassle-free banking solutions made just for you.</p>
            <a href="apply.html" class="apply-btn">Apply Now</a>
        </div>
    </div>
    <div class="subbody">
        <section class="why-choose-us py-5">
            <div class="container text-center">
                <h2 class="mb-5">Why Choose Us?</h2>
                <div class="reasons d-flex justify-content-center flex-wrap gap-4">
                    <div class="reason">
                        <div class="circle">üí∞</div>
                        <h5>Low Interest Rates</h5>
                    </div>
                    <div class="reason">
                        <div class="circle">‚ö°</div>
                        <h5>Fast Processing</h5>
                    </div>
                    <div class="reason">
                        <div class="circle">üîí</div>
                        <h5>Secure & Transparent</h5>
                    </div>
                    <div class="reason">
                        <div class="circle">ü§ù</div>
                        <h5>Trusted Support</h5>
                    </div>
                </div>
            </div>
        </section>

        <section class="walkthrough-section container my-5">
            <div class="row align-items-stretch">
                <div class="col-lg-6 mb-4 mb-lg-0 d-flex">
                    <div class="video-wrapper flex-fill">
                        <iframe width="100%" height="100%" src="https://www.youtube.com/embed/tgbNymZ7vqY" title="Loan Walkthrough Video" frameborder="0" allowfullscreen></iframe>
                    </div>
                </div>

                <div class="col-lg-6 d-flex">
                    <div class="quote-box flex-fill">
                        <h2 class="quote-text">‚ÄúA small loan today can build your big dreams tomorrow.‚Äù</h2>
                        <p class="quote-author">‚Äì Bank Loan Services</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="testimonials">
            <div class="container">
                <h2 class="section-title">What Our Customers Say</h2>
                <div class="testimonial-cards">
                    <div class="testimonial-card">
                        <p class="testimonial-text">
                            "LoanBank made my dream of buying a home come true. The process was smooth and transparent!"
                        </p>
                        <div class="customer-info">
                            <div>
                                <h4>Rajesh Kumar</h4>
                                <span>Home Loan Customer</span>
                            </div>
                        </div>
                    </div>
                    <div class="testimonial-card">
                        <p class="testimonial-text">
                            "I got an education loan within days. The staff were very supportive and guided me step by step."
                        </p>
                        <div class="customer-info">
                            <div>
                                <h4>Ananya Sharma</h4>
                                <span>Education Loan Customer</span>
                            </div>
                        </div>
                    </div>
                    <div class="testimonial-card">
                        <p class="testimonial-text">
                            "The best part about LoanBank is their quick approval. I received my vehicle loan in just 48 hours!"
                        </p>
                        <div class="customer-info">
                            <div>
                                <h4>Vikram Singh</h4>
                                <span>Vehicle Loan Customer</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <footer class="footer">
        <div class="footer-container">
            <div class="social-icons">
                <a href="https://facebook.com"><i class="fab fa-facebook-f"></i></a>
                <a href="https://twitter.com"><i class="fab fa-twitter"></i></a>
                <a href="https://instagram.com"><i class="fab fa-instagram"></i></a>
                <a href="https://linkedin.com"><i class="fab fa-linkedin-in"></i></a>
            </div>
            <div class="footer-section">
                <h4>About Us</h4>
                <p>
                    We provide secure and efficient loan management services tailored to meet customer needs.
                    Our mission is to simplify the loan process and ensure transparency.
                </p>
            </div>
            <div class="footer-section">
                <h4>Contact Us</h4>
                <p>Email: support@loanbank.com</p>
                <p>Phone: +91-9876543210</p>
                <p>Address: 123 Finance Street, Chennai, TN</p>
            </div>
        </div>
        <div class="footer-bottom">
            ¬© 2025 All rights reserved.
        </div>
    </footer>
</div>
<script>
    // Simple function to check if user is logged in (optional for homepage)
    function checkLoginStatus() {
        const email = localStorage.getItem("loggedInEmail");

        if (email) {
            // User is logged in - try to get their data
            const savedUserData = localStorage.getItem("loggedInCustomer");

            if (savedUserData) {
                // Use saved data
                const userData = JSON.parse(savedUserData);
                updateNavbar(userData);
            } else {
                // Get fresh data from server
                getUserData(email);
            }
        }
        // If not logged in, navbar stays as "Login/Register" (default)
    }

    // Get user data from server
    function getUserData(email) {
        $.ajax({
            url: "http://localhost:8089/api/customers/email/" + email,
            method: "GET",
            success: function(data) {
                // Save user data
                localStorage.setItem("loggedInCustomer", JSON.stringify(data));
                // Update navbar to show user's name
                updateNavbar(data);
            },
            error: function() {
                console.log("Could not load user data");
            }
        });
    }

    // Update navbar to show user's name instead of login button
    // Update navbar to show user's name instead of login button
function updateNavbar(userData) {
    console.log("updateNavbar function called.");
    console.log("User Data:", userData);

    const loginButton = document.getElementById("loginButton");

    if (loginButton) {
        // Create the profile dropdown wrapper and its contents
        const profileDropdownWrapper = document.createElement("div");
        profileDropdownWrapper.className = "profile-dropdown";
        profileDropdownWrapper.innerHTML = `
            <button class="profile-button">
                ${userData.name.split(' ')[0]}
            </button>
            <div class="dropdown-menu" id="profileDropdown">
                <a href="profile.html" class="dropdown-item">View Profile</a>
                <a href="#" class="dropdown-item" id="logoutLink">Logout</a>
            </div>
        `;

        // Replace the login button with the new profile dropdown
        loginButton.replaceWith(profileDropdownWrapper);

        // Add event listeners to the new elements
        const profileButton = profileDropdownWrapper.querySelector('.profile-button');
        if (profileButton) {
            profileButton.addEventListener('click', toggleDropdown);
        }

        const logoutLink = document.getElementById('logoutLink');
        if (logoutLink) {
            logoutLink.addEventListener('click', logout);
        }
    }
}

    // Toggle dropdown menu
    function toggleDropdown() {
        const dropdown = document.getElementById("profileDropdown");
        if (dropdown) {
            dropdown.classList.toggle("show");
        }
    }

    // Close dropdown when clicking outside
    window.onclick = function(event) {
        if (!event.target.matches('.profile-button')) {
            const dropdown = document.getElementById("profileDropdown");
            if (dropdown && dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
            }
        }
    }

    // Logout function
    function logout() {
        if (confirm("Are you sure you want to logout?")) {
            localStorage.removeItem("loggedInEmail");
            localStorage.removeItem("loggedInCustomer");
            window.location.href = "login.html";
        }
    }

    // Start the page by checking login status
    $(document).ready(function() {
        checkLoginStatus();
    });
</script>
</body>
</html>